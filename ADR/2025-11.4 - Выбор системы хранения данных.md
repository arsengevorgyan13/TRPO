**Дата:** 29 ноября 2025 г.

**Статус:** Принято

**Контекст:**

Для системы управления автопарком необходима надежная и масштабируемая система хранения данных, способная эффективно обрабатывать различные типы данных: структурированные данные (автомобили, водители, маршруты), потоковые GPS-данные в реальном времени, исторические данные о перемещениях и операционные данные для отчетности.

**Рассмотренные варианты:**

1. **PostgreSQL:** Реляционная система управления базами данных с расширенными возможностями.
2. **MySQL:** Популярная реляционная система управления базами данных.
3. **MongoDB:** Документоориентированная система управления базами данных.
4. **Cassandra:** Распределенная NoSQL система управления базами данных.

**Решение:**

Выбрана PostgreSQL.

**Обоснование:**

- **Надежность и транзакционная целостность:** PostgreSQL обеспечивает полную поддержку ACID, что критически важно для операционных данных системы (учет автомобилей, водителей, расписаний), где необходима гарантированная целостность данных и согласованность транзакций.
- **Расширение PostGIS:** Встроенная поддержка геопространственных данных через расширение PostGIS позволяет эффективно хранить и обрабатывать GPS-координаты, выполнять пространственные запросы для мониторинга перемещений и построения маршрутов, что соответствует функциональным требованиям F04 и F09.
- **Гибкость данных:** Поддержка JSONB позволяет хранить полуструктурированные данные (технические характеристики автомобилей, дополнительные параметры маршрутов), сохраняя при этом возможность сложных SQL-запросов.
- **Производительность сложных запросов:** Оптимизированный планировщик запросов и продвинутые индексы (включая GiST для геоданных) обеспечивают высокую производительность при генерации отчетов и аналитике работы автопарка.
- **Масштабируемость:** Поддержка репликации и возможность шардирования через сторонние решения (например, Citus) позволяют масштабировать систему в соответствии с требованиями SCA01-SCA04.
- **Зрелость и сообщество:** Большое активное сообщество, надежная экосистема инструментов для мониторинга, резервного копирования и управления.

**Недостатки решения:**

- **Производительность при массовой записи потоковых данных:** При очень высокой частоте записи GPS-данных от тысяч транспортных средств PostgreSQL может требовать дополнительной оптимизации по сравнению со специализированными временными рядами базами данных.
- **Сложность горизонтального масштабирования записи:** Нативное горизонтальное масштабирование для операций записи требует дополнительных решений и более сложной настройки по сравнению с изначально распределенными системами, такими как Cassandra.
- **Требует тщательной настройки и оптимизации:** Для достижения максимальной производительности при работе с большими объемами геоданных и исторической информации требуется глубокая экспертиза в настройке и оптимизации запросов.

**Последствия:**

- Все данные системы (операционные данные, GPS-координаты, история перемещений) будут храниться в PostgreSQL с использованием расширения PostGIS.
- Необходимо выделить отдельного специалиста или обеспечить обучение команды для работы с PostGIS и оптимизации геопространственных запросов.
- Для обработки пиковых нагрузок по записи GPS-данных потребуется реализация буферизации и пакетной вставки данных.
- Архитектура базы данных должна быть спроектирована с учетом партиционирования исторических GPS-данных по времени для обеспечения производительности.
- Регулярное резервное копирование и мониторинг производительности базы данных становятся критически важными операционными задачами.